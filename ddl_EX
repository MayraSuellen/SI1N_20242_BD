CREATE schema DDL_EX;
USE DDL_EX;
# FASE 3: CRIANDO AS TABELAS SEM CHAVES ESTRANGEIRAS
CREATE TABLE IF NOT EXISTS LOCAL (
#NOMEDOATRIBUTO - TIPO - RESTRIÇÃO DE INTEGRIDADE(OPCIONAL)
LOCAL_ID INT PRIMARY KEY,
NOME VARCHAR(100) NOT NULL,
LOG_LOCAL VARCHAR(100) NOT NULL,
NUMLOG_LOCAL INT,
BAIRRO_LOCAL VARCHAR(100) NOT NULL,
CIDADE VARCHAR(100) NOT NULL,
UF char(45) NOT NULL,
CEP VARCHAR(20) NOT NULL,
CAPACIDADE int
);

CREATE TABLE IF NOT EXISTS EVENTOS(
ID_EVENTO INT PRIMARY KEY,
NOME_EVENTO VARCHAR(100) NOT NULL,
DATA_EVENTO date NOT NULL,
ENTIDADE_EVENTO VARCHAR(100) NOT NULL,
LOCAL_EVENTO INT NULL
);

CREATE TABLE IF NOT EXISTS ATIVIDADE(
ID_ATIVIDADE INT PRIMARY KEY,
NOME_ATV VARCHAR(100) NOT NULL,
DATA_ATV date NOT NULL,
HORA_ATV time NULL,
EVENTO_ATV int NOT NULL
);

CREATE TABLE IF NOT EXISTS PARTICIPANTES(
NUM_INSCRICAO INT PRIMARY KEY,
CPF INT primary key,
NOME varchar (100) NOT NULL,
DATA_NASC date NULL,
EMPRESA varchar(100) NOT NULL
);
#FASE 4: CRIAR AS TABELAS COM DEPENDÊNCIA DE CHAVE ESTRANGEIRA

CREATE TABLE IF NOT EXISTS PARTICIPANTES_ATIVIDADE(
INSCRICAO INT NOT NULL,
CPF varchar(20) NOT NULL,
ATIVIDADE INT NOT NULL,
CONSTRAINT FK_INSCRICAO FOREIGN KEY (NUM_INSCRICAO)
REFERENCES PARTICIPANTES(NUM_INCRICAO),
CONSTRAINT FK_CPF FOREIGN KEY (CPF)
REFERENCES PARTICIPANTES(CPF),
CONSTRAINT FK_ATIVIDADE FOREIGN KEY (ID_ATIVIDADE)
REFERENCES ATIVIDADE(ID_ATIVIDADE)
);

CREATE TABLE IF NOT EXISTS PARTICIPANTES_ATIVIDADE(
INSCRICAO INT NOT NULL,
CPF varchar(20) NOT NULL,
ATIVIDADE INT NOT NULL,
primary key (NUM_INCRICAO,CPF,ID_ATIVIDADE),
CONSTRAINT FK_PARTICIPANTES FOREIGN KEY (INSCRICAO, CPF)
REFERENCES PARTICIPANTES(NUM_INCRICAO),
CONSTRAINT FK_ATIVIDADE FOREIGN KEY (ID_ATIVIDADE)
REFERENCES ATIVIDADE(ID_ATIVIDADE)
);

CREATE TABLE IF NOT EXISTS PARTICIPANTES_EVENTO(
INSCRICAO INT NOT NULL,
CPF varchar(20) NOT NULL,
EVENTO INT NOT NULL,
primary key (NUM_INCRICAO,CPF,ID_EVEMTO),
CONSTRAINT FK_PARTICIPANTES FOREIGN KEY (INSCRICAO, CPF)
REFERENCES PARTICIPANTES(NUM_INCRICAO),
CONSTRAINT FK_EVENTO FOREIGN KEY (ID_EVENTO)
REFERENCES EVENTO (ID_EVENTO)
);
